<div class="contact-us">
  <div class="container">
    <div class="row">
      <div class="col-12 pt-lg-2 text-center text-lg-left">
        <div class="px-3 px-lg-0 pt-lg-1 my-3 contact-us-header"><h2>Delivery Status for #<%= @order.number %></h2></div>
      </div>
      <div class="col-12 text-lg-left text-center pb-2">
        <p>If you have any questions, please <a href="<%= @contact_link.present? ? @contact_link : '/pages/contact-us' %>" class="text-danger"> contact us</a> or email us at
          <a href="mailto: <%= current_store.contact_email %>" class="text-danger"><%= current_store.contact_email %></a></p>
      </div>
      <div class="col-12 col-lg-2 mt-lg-0">
      </div>
      <div class="col-12 col-lg-8 mt-lg-0">
        <div class="jumbotron">
          <h3>Ship to</h3> 
          <p><%= render 'spree/shared/address_line', address: @order.shipping_address %></p>

          <div class="order-timeline">
            <ul class="timeline">

              <li class="event" data-date="">
                <h3><%= @events[:delivered][:description] %></h3>
              </li>

              <li class="event" data-date="">
                <h3><%= @events[:in_transit][:description] %></h3>
              </li>

              
              <li class="event" data-date="<%= @order.shipped? && @order.shipment_state == "shipped" ? @events[:shipped][:record_time].strftime('%Y-%m-%d %T') : "" %>">
                <h3><%= @events[:shipped][:description] %></h3>
                <% if @order.shipped? && @order.shipment_state == "shipped" %>
                <ul>
                  <% @events[:shipped][:shipments].each do |shipment| %>
                    <li><% shipment[:manifest].each do |item| %>
                        <%= mini_image(item.variant) unless item.variant.nil? %>
                        <% end %>
                        <p><%= shipment[:carrier] + " Tracking: " + shipment[:tracking] %></p>
                    </li>
                  <% end %>
                </ul>
                <% end %>
              </li>
              

              <% if @order.shipped? && @order.shipment_state == "partial" %>
              <li class="event" data-date="<%= @order.shipped? && @order.shipment_state == "partial" ? @events[:partial_shipped][:record_time].strftime('%Y-%m-%d %T') : "" %>">
                <h3><%= @events[:partial_shipped][:description] %></h3>
                <ul>
                  <% @events[:partial_shipped][:shipments].each do |shipment| %>
                    <li><% shipment[:manifest].each do |item| %>
                        <%= mini_image(item.variant) unless item.variant.nil? %>
                        <% end %>

                        <p><%= shipment[:carrier] + " Tracking: " + shipment[:tracking] %></p>
                    </li>
                  <% end %>
                </ul>
              </li>
              <% end %>

              <li class="event" data-date="<%= @order.approved? ? @events[:packing][:record_time].strftime('%Y-%m-%d %T') : "" %>">
                <h3><%= @events[:packing][:description] %></h3>
              </li>


              <li class="event" data-date="<%= @events[:submitted][:record_time].strftime('%Y-%m-%d %T') %>">
                <h3><%= @events[:submitted][:description] %></h3>
              </li>
              
              
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style type="text/css">
.timeline {
    border-left: 3px solid #727cf5;
    border-bottom-right-radius: 4px;
    border-top-right-radius: 4px;
    margin: 0 0 0 auto;
    letter-spacing: 0.2px;
    position: relative;
    line-height: 1.4em;
    font-size: 1.03em;
    padding: 50px;
    list-style: none;
    text-align: left;
    max-width: 60%;
}

@media (max-width: 767px) {
    .timeline {
        max-width: 98%;
        padding: 25px;
    }
}

.timeline h1 {
    font-weight: 300;
    font-size: 1.4em;
}

.timeline h2,
.timeline h3 {
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 10px;
}

.timeline .event {
    border-bottom: 1px dashed #e8ebf1;
    padding-bottom: 25px;
    margin-bottom: 25px;
    position: relative;
}

@media (max-width: 767px) {
    .timeline .event {
        padding-top: 30px;
    }
}

.timeline .event p {
    margin: 5px 0;
}

.timeline .event:last-of-type {
    padding-bottom: 0;
    margin-bottom: 0;
    border: none;
}

.timeline .event:before,
.timeline .event:after {
    position: absolute;
    display: block;
    top: 0;
}

.timeline .event:before {
    left: -207px;
    content: attr(data-date);
    text-align: right;
    font-weight: 100;
    font-size: 0.9em;
    min-width: 120px;
}

@media (max-width: 767px) {
    .timeline .event:before {
        left: 0px;
        text-align: left;
    }
}

.timeline .event:after {
    -webkit-box-shadow: 0 0 0 3px #727cf5;
    box-shadow: 0 0 0 3px #727cf5;
    left: -55.8px;
    background: #fff;
    border-radius: 50%;
    height: 9px;
    width: 9px;
    content: "";
    top: 5px;
}

@media (max-width: 767px) {
    .timeline .event:after {
        left: -31.8px;
    }
}

.rtl .timeline {
    border-left: 0;
    text-align: right;
    border-bottom-right-radius: 0;
    border-top-right-radius: 0;
    border-bottom-left-radius: 4px;
    border-top-left-radius: 4px;
    border-right: 3px solid #727cf5;
}

.rtl .timeline .event::before {
    left: 0;
    right: -170px;
}

.rtl .timeline .event::after {
    left: 0;
    right: -55.8px;
}
</style>